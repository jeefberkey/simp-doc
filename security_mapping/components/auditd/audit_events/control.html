

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7.1.5.1. Audit Events &mdash; SIMP 5.2.1-0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../../_static/css_overrides.css" type="text/css" />
  

  
    <link rel="top" title="SIMP 5.2.1-0 documentation" href="../../../../index.html"/>
        <link rel="up" title="7.1.5. Auditd" href="../auditd.html"/>
        <link rel="next" title="7.1.5.2. Audit Generation" href="../audit_generation/control.html"/>
        <link rel="prev" title="7.1.5. Auditd" href="../auditd.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../../../index.html">
        

        
          
          <img src="../../../../_static/SIMP_Logo.png" class="logo" />
        
        </a>

        
          
          
            <div class="version">
              5.2.1
            </div>
          
        

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../index.html">Welcome to the SIMP documentation!</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started_guide/Just_Install.html">1. For the Impatient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dynamic/Changelog.html">2. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started_guide/index.html">3. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user_guide/index.html">4. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributors_guide/index.html">5. Contributing to SIMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../security_conop/index.html">6. Security Concept of Operations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">7. Security Control Mapping</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../Components.html">7.1. SIMP Components</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../simplib/simplib.html">7.1.1. SIMPLib</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../simp/simp.html">7.1.2. SIMP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aide/aide.html">7.1.3. AIDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../apache/apache.html">7.1.4. Apache</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../auditd.html">7.1.5. Auditd</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="">7.1.5.1. Audit Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../audit_generation/control.html">7.1.5.2. Audit Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../audit_reviews_and_updates/control.html">7.1.5.3. Audit Reviews and Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../audit_storage_capacity/control.html">7.1.5.4. Audit Storage Capacity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../content_of_audit_records/control.html">7.1.5.5. Content of Audit Records</a></li>
<li class="toctree-l4"><a class="reference internal" href="../response_to_audit_processing_failures/control.html">7.1.5.6. Response to Audit Processing Failures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../response_to_audit_processing_failures_audit_storage_capacity/control.html">7.1.5.7. Response To Audit Processing Failures - Audit Storage Capacity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transfer_to_alternate_storage/control.html">7.1.5.8. Transfer to Alternate Storage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../clamav/clamav.html">7.1.6. ClamAV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../compliance/compliance.html">7.1.7. Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../iptables/iptables.html">7.1.8. IPTables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../named/named.html">7.1.9. Named/Bind</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../openldap/openldap.html">7.1.10. OpenLDAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pam/pam.html">7.1.11. PAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../pupmod/pupmod.html">7.1.12. Pupmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rsync/rsync.html">7.1.13. Rsync</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ssh/ssh.html">7.1.14. SSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stunnel/stunnel.html">7.1.15. Stunnel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sudo/sudo.html">7.1.16. Sudo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sudosh/sudosh.html">7.1.17. Sudosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tcpwrappers/tcpwrappers.html">7.1.18. TCP Wrappers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Controls.html">7.2. Security Control Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#indices-and-tables">7.3. Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../help/index.html">8. Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html">9. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html#contact">10. Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary.html">11. Glossary of Terms</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../index.html">SIMP</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../index.html">7. SIMP Security Control Mapping</a> &raquo;</li>
      
          <li><a href="../../../Components.html">7.1. SIMP Components</a> &raquo;</li>
      
          <li><a href="../auditd.html">7.1.5. Auditd</a> &raquo;</li>
      
    <li>7.1.5.1. Audit Events</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/security_mapping/components/auditd/audit_events/control.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="audit-events">
<h1>7.1.5.1. Audit Events<a class="headerlink" href="#audit-events" title="Permalink to this headline">Â¶</a></h1>
<p>SIMP audit rules were built by using industry best practices gathered over the
years. The heaviest reliance has been on the SCAP-Security Guide (SSG). SIMP
aims for a balance between performance and operational needs so the settings are
rarely an exact match from these guides.</p>
<p>The following audit rules are applied to SIMP systems:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>## For audit 1.6.5 and higher
##

# Ignore errors
# This may sound counterintuitive, but we&#39;d rather skip bad rules and load the
# rest than miss half the file.  Warnings are still logged in the daemon
# restart output.
-i

## Remove any existing rules
-D

## Continue loading rules on failure.
# Particularly with the automatically generated nature of these rules in
# Puppet, it is possible that one or more may fail to load. We want to continue
# in that case so that we audit as much as possible.
-c

## Increase buffer size to handle the increased number of messages.
## Feel free to increase this if the machine panic&#39;s
# Default: 8192
-b 32768

## Set failure mode to panic
# Default: 2
-f 1

## Rate limit messages
# Default: 0
# If you set this to non-zero, you almost definitely want to set -f to 1 above.
-r 0

## Get rid of all anonymous and daemon junk.  It clogs up the logs and doesn&#39;t
# do anyone # any good.
-a exit,never -F auid=-1

# Ignore system services. In most guides this is tagged onto every rule but
# that just makes for more processing time.
-a exit,never -F auid!=0 -F auid&lt;500

## unsuccessful file operations
-a always,exit -F arch=b64 -S creat -S mkdir -S mknod -S link -S symlink -S
mkdirat -S mknodat -S linkat -S symlinkat -S openat -S open -S close -S rename
-S truncate -S ftruncate -S rmdir -S unlink -S unlinkat -F exit=-EPERM -k access
-a always,exit -F arch=b32 -S creat -S mkdir -S mknod -S link -S symlink -S
mkdirat -S mknodat -S linkat -S symlinkat -S openat -S open -S close -S rename
-S truncate -S ftruncate -S rmdir -S unlink -S unlinkat -F exit=-EPERM -k access

-a always,exit -F perm=a -F exit=-EPERM -k access

# Permissions auditing
-a always,exit -F arch=b64 -S chown -S fchmod -S fchmodat -S fchown -S fchownat
-S lchown -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr
-S fremovexattr -k perm_mod
-a always,exit -F arch=b32 -S chown -S fchmod -S fchmodat -S fchown -S fchownat
-S lchown -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr
-S fremovexattr -k perm_mod

# Audit useful items that someone does when su&#39;ing to root.
# Had to add an entry at the top for getting rid of anonymous records.  They
# are only moderately useful and contain *way* too much noise since this covers
# things like cron as well.

-a always,exit -F arch=b64 -F auid!=0 -F uid=0 -S capset -S mknod -S pivot_root
-S quotactl -S setsid -S settimeofday -S setuid -S swapoff -S swapon -k
su-root-activity
-a always,exit -F arch=b32 -F auid!=0 -F uid=0 -S capset -S mknod -S pivot_root
-S quotactl -S setsid -S settimeofday -S setuid -S swapoff -S swapon -k
su-root-activity

# Audit the execution of suid and sgid binaries.
-a always,exit -F arch=b64 -F euid=0 -F uid!=0 -S execve -k suid-root-exec
-a always,exit -F arch=b32 -F euid=0 -F uid!=0 -S execve -k suid-root-exec

## Audit the loading and unloading of kernel modules.
-w /sbin/insmod -p x -k modules
-w /sbin/rmmod -p x -k modules
-w /sbin/modprobe -p x -k modules
-a always,exit -F arch=b64 -S init_module -S delete_module -k modules
-a always,exit -F arch=b32 -S init_module -S delete_module -k modules

## Things that could affect time
-a exit,always -F arch=b32 -S adjtimex -S stime -S clock_settime -S settimeofday
-k audit_time_rules
-a exit,always -F arch=b64 -S adjtimex -S clock_settime -S settimeofday -k
audit_time_rules

-w /etc/localtime -p wa -k audit_time_rules

## Things that could affect system locale
-a always,exit -F arch=b32 -S sethostname -S setdomainname -k
audit_network_modifications
-a always,exit -F arch=b64 -S sethostname -S setdomainname -k
audit_network_modifications
-w /etc/issue -p wa -k audit_network_modifications
-w /etc/issue.net -p wa -k audit_network_modifications
-w /etc/hosts -p wa -k audit_network_modifications
-w /etc/sysconfig/network -p wa -k audit_network_modifications

# Mount options.
-a always,exit -F arch=b32 -S mount -S umount -S umount2 -k mount
-a always,exit -F arch=b64 -S mount -S umount2 -k mount

# audit umask changes.
# This is uselessly noisy.
# -a exit,always -S umask -k umask

-w /etc/group -p wa -k audit_account_changes
-w /etc/group- -p wa -k audit_account_changes
-w /etc/passwd -p wa -k audit_account_changes
-w /etc/passwd- -p wa -k audit_account_changes
-w /etc/gshadow -p wa -k audit_account_changes
-w /etc/shadow -p wa -k audit_account_changes
-w /etc/shadow- -p wa -k audit_account_changes
-w /etc/security/opasswd -p wa -k audit_account_changes

-w /etc/selinux/ -p wa -k MAC-policy

-w /var/log/faillog -p wa -k logins
-w /var/log/lastlog -p wa -k logins

-w /var/run/utmp -p wa -k session
-w /var/run/btmp -p wa -k session
-w /var/run/wtmp -p wa -k session

-w /etc/sudoers -p wa -k CFG_sys

# Generally good things to audit.
-w /boot/grub/grub.conf -p wa -k CFG_grub
-w /etc/aliases -p wa -k CFG_sys
-w /etc/anacrontab -p wa -k CFG_cron
-w /etc/at.deny -p wa -k CFG_sys
-w /etc/bashrc -p wa -k CFG_shell
-w /etc/cron.d -p wa -k CFG_cron
-w /etc/cron.daily -p wa -k CFG_cron
-w /etc/cron.deny -p wa -k CFG_cron
-w /etc/cron.hourly -p wa -k CFG_cron
-w /etc/cron.monthly -p wa -k CFG_cron
-w /etc/cron.weekly -p wa -k CFG_cron
-w /etc/crontab -p wa -k CFG_cron
-w /etc/csh.cshrc -p wa -k CFG_shell
-w /etc/csh.login -p wa -k CFG_shell
-w /etc/default -p wa -k CFG_sys
-w /etc/exports -p wa -k CFG_sys
-w /etc/fstab -p wa -k CFG_sys
-w /etc/host.conf -p wa -k CFG_sys
-w /etc/hosts.allow -p wa -k CFG_sys
-w /etc/hosts.deny -p wa -k CFG_sys
-w /etc/initlog.conf -p wa -k CFG_sys
-w /etc/inittab -p wa -k CFG_sys
-w /etc/issue -p wa -k CFG_sys
-w /etc/issue.net -p wa -k CFG_sys
-w /etc/krb5.conf -p wa -k CFG_sys
-w /etc/ld.so.conf -p wa -k CFG_sys
-w /etc/ld.so.conf.d -p wa -k CFG_sys
-w /etc/login.defs -p wa -k CFG_sys
-w /etc/modprobe.conf.d -p wa -k CFG_sys
-w /etc/modprobe.d/00_simp_blacklist.conf -p wa -k CFG_sys
-w /etc/nsswitch.conf -p wa -k CFG_sys
-w /etc/pam.d -p wa -k CFG_pam
-w /etc/pam_smb.conf -p wa -k CFG_pam
-w /etc/profile -p wa -k CFG_shell
-w /etc/rc.d/init.d -p wa -k CFG_sys
-w /etc/rc.local -p wa -k CFG_sys
-w /etc/rc.sysinit -p wa -k CFG_sys
-w /etc/resolv.conf -p wa -k CFG_sys
-w /etc/securetty -p wa -k CFG_sys
-w /etc/security -p wa -k CFG_security
-w /etc/services -p wa -k CFG_services
-w /etc/shells -p wa -k CFG_shell
-w /etc/snmp/snmpd.conf -p wa -k CFG_sys
-w /etc/ssh/sshd_config -p wa -k CFG_sys
-w /etc/sysconfig -p wa -k CFG_sys
-w /etc/sysctl.conf -p wa -k CFG_sys
-w /etc/xinetd.conf -p wa -k CFG_xinetd
-w /etc/xinetd.d -p wa -k CFG_sys
-w /etc/yum.conf -p wa -k yum-config
-w /etc/yum.repos.d -p wa -k yum-config
-w /lib/firmware/microcode.dat -p wa -k CFG_sys
-w /var/spool/at -p wa -k CFG_sys
-a exit,always -F arch=b32 -S ptrace -k paranoid
-a exit,always -F arch=b64 -S ptrace -k paranoid
-a always,exit -F arch=b32 -S personality -k paranoid
-a always,exit -F arch=b64 -S personality -k paranoid
-w /etc/aide.conf -p wa -k CFG_aide
-w /etc/aide.conf.d/default.aide -p wa -k CFG_aide
-w /etc/rc.d/init.d/auditd -p wa -k auditd
-w /var/log/audit.log -p wa -k audit-logs
-w /etc/pam_ldap.conf -p a -k CFG_etc_ldap
-w /etc/pki/private -p wa -k PKI
-w /etc/pki/public -p wa -k PKI
-w /etc/pki/cacerts -p wa -k PKI
-w /etc/pki/private/blade01.tasty.bacon.pem -p wa -k PKI
-w /etc/pki/public/blade01.tasty.bacon.pub -p wa -k PKI
-a always,exit -F dir=/etc/puppet -F uid!=puppet -p wa -k Puppet_Config
-a always,exit -F dir=/var/log/puppet -F uid!=puppet -p wa -k Puppet_Log
-a always,exit -F dir=/var/run/puppet -F uid!=puppet -p wa -k Puppet_Run
-a always,exit -F dir=$vardir/ssl -F uid!=puppet -p wa -k Puppet_SSL
-w /var/log/audit.log.1 -p rwa -k audit-logs
-w /var/log/audit.log.2 -p rwa -k audit-logs
-w /var/log/audit.log.3 -p rwa -k audit-logs
-w /var/log/audit.log.4 -p rwa -k audit-logs
-w /var/log/audit.log.5 -p rwa -k audit-logs
-w /etc/init/ -p wa -k CFG_upstart
</pre></div>
</div>
<p>References: <a class="reference internal" href="../../../controls/nist80053rev4/800-53-controls.html#id285"><span>AU-2</span></a></p>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../audit_generation/control.html" class="btn btn-neutral float-right" title="7.1.5.2. Audit Generation" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../auditd.html" class="btn btn-neutral" title="7.1.5. Auditd" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, THE SIMP TEAM.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'4.2.X',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>