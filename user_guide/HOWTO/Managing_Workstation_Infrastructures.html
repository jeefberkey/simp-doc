

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.7.10. HOWTO Manage Workstation Infrastructures &mdash; SIMP 5.2.1-0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css_overrides.css" type="text/css" />
  

  
    <link rel="top" title="SIMP 5.2.1-0 documentation" href="../../index.html"/>
        <link rel="up" title="4.7. SIMP HOWTO Guides" href="../HOWTO.html"/>
        <link rel="next" title="4.7.11. HOWTO Kickstart the Initial Server" href="Network_Build.html"/>
        <link rel="prev" title="4.7.9. HOWTO Enable Kerberos" href="Kerberos.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../index.html">
        

        
          
          <img src="../../_static/SIMP_Logo.png" class="logo" />
        
        </a>

        
          
          
            <div class="version">
              5.2.1
            </div>
          
        

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to the SIMP documentation!</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started_guide/Just_Install.html">1. For the Impatient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dynamic/Changelog.html">2. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started_guide/index.html">3. Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">4. User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Introduction.html">4.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Client_Management.html">4.2. Client Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SIMP_Administration.html">4.3. General Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../User_Management.html">4.4. User Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Hiera_Overview.html">4.5. Hiera Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Troubleshooting.html">4.6. Troubleshooting Common Issues</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../HOWTO.html">4.7. SIMP HOWTO Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Central_Log_Collection.html">4.7.1. Setup Central Log Collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="Changing_Puppet_Masters.html">4.7.2. Change Puppet Masters</a></li>
<li class="toctree-l3"><a class="reference internal" href="Disable_dhcpd.html">4.7.3. Disable dhcpd</a></li>
<li class="toctree-l3"><a class="reference internal" href="Disable_named.html">4.7.4. Disable named</a></li>
<li class="toctree-l3"><a class="reference internal" href="Discard_Mail_to_Root.html">4.7.5. Discard Mail to Root</a></li>
<li class="toctree-l3"><a class="reference internal" href="Exclude_Repositories.html">4.7.6. Exclude YUM Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="NFS.html">4.7.7. Configure NFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="IPTables_NAT_Rules.html">4.7.8. Configure IPTables NAT Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="Kerberos.html">4.7.9. Enable Kerberos</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">4.7.10. Manage Workstation Infrastructures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#user-workstation-setup">4.7.10.1. User Workstation Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#graphical-desktop-setup">4.7.10.2. Graphical Desktop Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workstation-repositories">4.7.10.3. Workstation Repositories</a></li>
<li class="toctree-l4"><a class="reference internal" href="#virtualization-on-user-workstations">4.7.10.4. Virtualization on User Workstations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#printer-setup">4.7.10.5. Printer Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vnc-setup">4.7.10.6. VNC Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Network_Build.html">4.7.11. Kickstart the Initial Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="Puppetmaster_Backup.html">4.7.12. Backup the Puppet Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="Puppet_Server_NAT.html">4.7.13. Configure a Puppet Server Behind a NAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="Redundant_LDAP.html">4.7.14. Enable Redundent LDAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="SFTP_Restricted_Accounts.html">4.7.15. Enable SFTP Restricted Accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="SSH_Keys.html">4.7.16. Setup SSH Authorized Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="Upgrade_SIMP.html">4.7.17. Upgrade SIMP (Coming Soon!)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Manage_TPM.html">4.7.18. Manage TPM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../SIMP_Package_Data.html">4.8. Package Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#indices-and-tables">4.9. Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors_guide/index.html">5. Contributing to SIMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security_conop/index.html">6. Security Concept of Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security_mapping/index.html">7. Security Control Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help/index.html">8. Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">9. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html#contact">10. Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">11. Glossary of Terms</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">SIMP</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">4. SIMP User Guide</a> &raquo;</li>
      
          <li><a href="../HOWTO.html">4.7. SIMP HOWTO Guides</a> &raquo;</li>
      
    <li>4.7.10. HOWTO Manage Workstation Infrastructures</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/user_guide/HOWTO/Managing_Workstation_Infrastructures.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="howto-manage-workstation-infrastructures">
<span id="infrastructure-setup"></span><h1>4.7.10. HOWTO Manage Workstation Infrastructures<a class="headerlink" href="#howto-manage-workstation-infrastructures" title="Permalink to this headline">¶</a></h1>
<p>This chapter describes how to manage client workstations with a SIMP
system including GUIs, repositories, virtualization, Network File System
(NFS), printing, and Virtual Network Computing (VNC).</p>
<div class="section" id="user-workstation-setup">
<h2>4.7.10.1. User Workstation Setup<a class="headerlink" href="#user-workstation-setup" title="Permalink to this headline">¶</a></h2>
<p>Below is an example class,
<code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/modules/site/manifests/workstation.pp</span></code>, that could be used to
set up a user workstation.</p>
<div class="highlight-puppet"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="na">site</span><span class="p">::</span><span class="na">workstation</span> <span class="p">{</span>
  <span class="k">include</span> <span class="s">&#39;site::gui&#39;</span>
  <span class="k">include</span> <span class="s">&#39;site::repos&#39;</span>
  <span class="k">include</span> <span class="s">&#39;site::virt&#39;</span>
  <span class="k">include</span> <span class="s">&#39;site::automount&#39;</span>
  <span class="k">include</span> <span class="s">&#39;site::print::client&#39;</span><span class="c"></span>

<span class="c">  # Make sure everyone can log into all nodes.</span>
<span class="c">  # If you want to change this, simply remove this line and add</span>
<span class="c">  # individual entries to your nodes as appropriate</span>
  <span class="na">pam</span><span class="p">::</span><span class="na">access</span><span class="p">::</span><span class="na">rule</span> <span class="p">{</span> <span class="s">&quot;Allow Users&quot;</span><span class="p">:</span>
    <span class="na">comment</span> <span class="o">=&gt;</span> <span class="s">&#39;Allow all users in the &quot;users&quot; group to access the system from anywhere.&#39;</span><span class="p">,</span>
    <span class="na">users</span>   <span class="o">=&gt;</span> <span class="p">[</span><span class="s">&#39;(users)&#39;</span><span class="p">],</span>
    <span class="na">origins</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s">&#39;ALL&#39;</span><span class="p">]</span>
  <span class="p">}</span><span class="c"></span>

<span class="c">  # General Use Packages</span>
  <span class="k">package</span> <span class="p">{</span> <span class="p">[</span>
    <span class="s">&#39;pidgin&#39;</span><span class="p">,</span>
    <span class="s">&#39;git&#39;</span><span class="p">,</span>
    <span class="s">&#39;control-center-extra&#39;</span><span class="p">,</span>
    <span class="s">&#39;gconf-editor&#39;</span><span class="p">,</span>
    <span class="s">&#39;evince&#39;</span><span class="p">,</span>
    <span class="s">&#39;libreoffice-writer&#39;</span><span class="p">,</span>
    <span class="s">&#39;libreoffice-xsltfilter&#39;</span><span class="p">,</span>
    <span class="s">&#39;libreoffice-calc&#39;</span><span class="p">,</span>
    <span class="s">&#39;libreoffice-impress&#39;</span><span class="p">,</span>
    <span class="s">&#39;libreoffice-emailmerge&#39;</span><span class="p">,</span>
    <span class="s">&#39;libreoffice-base&#39;</span><span class="p">,</span>
    <span class="s">&#39;libreoffice-math&#39;</span><span class="p">,</span>
    <span class="s">&#39;libreoffice-pdfimport&#39;</span><span class="p">,</span>
    <span class="s">&#39;bluefish&#39;</span><span class="p">,</span>
    <span class="s">&#39;gnome-media&#39;</span><span class="p">,</span>
    <span class="s">&#39;pulseaudio&#39;</span><span class="p">,</span>
    <span class="s">&#39;file-roller&#39;</span><span class="p">,</span>
    <span class="s">&#39;inkscape&#39;</span><span class="p">,</span>
    <span class="s">&#39;gedit-plugins&#39;</span><span class="p">,</span>
    <span class="s">&#39;planner&#39;</span>
  <span class="p">]:</span> <span class="na">ensure</span> <span class="o">=&gt;</span> <span class="s">&#39;latest&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="graphical-desktop-setup">
<h2>4.7.10.2. Graphical Desktop Setup<a class="headerlink" href="#graphical-desktop-setup" title="Permalink to this headline">¶</a></h2>
<p>Below is an example manifest called
<code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/modules/site/manifests/gui.pp</span></code> for setting up a graphical
desktop on a user workstation.</p>
<div class="highlight-puppet"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="na">site</span><span class="p">::</span><span class="na">gui</span> <span class="p">{</span>
  <span class="k">include</span> <span class="s">&#39;gdm&#39;</span>
  <span class="k">include</span> <span class="s">&#39;gnome&#39;</span>
  <span class="k">include</span> <span class="s">&#39;vnc::client&#39;</span><span class="c"></span>

<span class="c">   # Compiz Stuff</span>
  <span class="k">package</span> <span class="p">{</span> <span class="p">[</span>
    <span class="s">&#39;fusion-icon&#39;</span><span class="p">,</span>
    <span class="s">&#39;emerald-themes&#39;</span><span class="p">,</span>
    <span class="s">&#39;compiz-fusion-extras&#39;</span><span class="p">,</span>
    <span class="s">&#39;compiz-fusion-extras-gnome&#39;</span><span class="p">,</span>
    <span class="s">&#39;vinagre&#39;</span>
  <span class="p">]:</span>
    <span class="na">ensure</span> <span class="o">=&gt;</span> <span class="s">&#39;latest&#39;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="workstation-repositories">
<h2>4.7.10.3. Workstation Repositories<a class="headerlink" href="#workstation-repositories" title="Permalink to this headline">¶</a></h2>
<p>Below is an example manifest called
<code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/modules/site/manifests/repos.pp</span></code> for setting up workstation
repositories.</p>
<div class="highlight-puppet"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="na">site</span><span class="p">::</span><span class="na">repos</span> <span class="p">{</span><span class="c"></span>
<span class="c">  # Whatever local yumrepo statements you need for installing</span>
<span class="c">  # your packages and keeping your systems up to date</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="virtualization-on-user-workstations">
<h2>4.7.10.4. Virtualization on User Workstations<a class="headerlink" href="#virtualization-on-user-workstations" title="Permalink to this headline">¶</a></h2>
<p>Below is an example manifest called
<code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/modules/site/manifests/virt.pp</span></code> for allowing virtualization
on a user workstation.</p>
<div class="highlight-puppet"><div class="highlight"><pre><span></span><span class="c"># We allow users to run VMs on their workstations.</span>
<span class="c"># If you don&#39;t want this, just don&#39;t include this class.</span>
<span class="c"># If this is installed, VM creation and management is still limited by PolicyKit</span>

<span class="k">class</span> <span class="na">site</span><span class="p">::</span><span class="na">virt</span> <span class="p">{</span>
  <span class="k">include</span> <span class="s">&#39;libvirt::kvm&#39;</span>
  <span class="k">include</span> <span class="s">&#39;libvirt::ksm&#39;</span>
  <span class="k">include</span> <span class="s">&#39;network&#39;</span>

  <span class="na">network</span><span class="p">::</span><span class="na">eth</span> <span class="p">{</span> <span class="s">&quot;em1&quot;</span><span class="p">:</span>
    <span class="na">bridge</span> <span class="o">=&gt;</span> <span class="s">&#39;br0&#39;</span><span class="p">,</span>
    <span class="na">hwaddr</span> <span class="o">=&gt;</span> <span class="nv">$facts</span><span class="p">[</span><span class="s">&#39;macaddress_em1&#39;</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="na">network</span><span class="p">::</span><span class="na">eth</span> <span class="p">{</span> <span class="s">&quot;br0&quot;</span><span class="p">:</span>
    <span class="na">net_type</span> <span class="o">=&gt;</span> <span class="s">&#39;Bridge&#39;</span><span class="p">,</span>
    <span class="na">hwaddr</span>   <span class="o">=&gt;</span> <span class="nv">$facts</span><span class="p">[</span><span class="s">&#39;macaddress_em1&#39;</span><span class="p">],</span>
    <span class="na">require</span>  <span class="o">=&gt;</span> <span class="na">Network</span><span class="p">::</span><span class="na">Eth</span><span class="p">[</span><span class="s">&#39;em1&#39;</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="k">class</span> <span class="p">{</span> <span class="s">&#39;swappiness&#39;</span><span class="p">:</span>
    <span class="na">high_swappiness</span> <span class="o">=&gt;</span> <span class="mi">80</span><span class="p">,</span>
    <span class="na">max_swappiness</span>  <span class="o">=&gt;</span> <span class="mi">100</span>
  <span class="p">}</span><span class="c"></span>

<span class="c">  # If 80% of memory is used, flush caches.</span>
  <span class="k">exec</span> <span class="p">{</span> <span class="s">&#39;flush_cache_himem&#39;</span><span class="p">:</span>
    <span class="na">command</span> <span class="o">=&gt;</span> <span class="s">&#39;/bin/echo 1 &gt; /proc/sys/vm/drop-caches&#39;</span><span class="p">,</span>
    <span class="na">onlyif</span> <span class="o">=&gt;</span> <span class="k">inline_template</span><span class="p">(</span><span class="s">&quot;/bin/&lt;%= memoryfree.split(/\s/)[0].</span>
<span class="s">    to_f/memorysize.split(/\s/)[0].to_f &lt; 0.2 ? true : false %&gt;&quot;</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">package</span> <span class="p">{</span> <span class="s">&#39;virt-manager&#39;</span><span class="p">:</span> <span class="na">ensure</span> <span class="o">=&gt;</span> <span class="s">&#39;latest&#39;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="printer-setup">
<h2>4.7.10.5. Printer Setup<a class="headerlink" href="#printer-setup" title="Permalink to this headline">¶</a></h2>
<p>Below are example manifests for setting up a printing environment.</p>
<div class="section" id="setting-up-a-print-client">
<h3>4.7.10.5.1. Setting up a Print Client<a class="headerlink" href="#setting-up-a-print-client" title="Permalink to this headline">¶</a></h3>
<p>Below is an example manifest called
<code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/modules/site/manifests/print/client.pp</span></code> for setting up a
print client.</p>
<div class="highlight-puppet"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="na">site</span><span class="p">::</span><span class="na">print</span><span class="p">::</span><span class="na">client</span> <span class="k">inherits</span> <span class="na">site</span><span class="p">::</span><span class="na">print</span><span class="p">::</span><span class="na">server</span> <span class="p">{</span>
  <span class="na">polkit</span><span class="p">::</span><span class="na">local_authority</span> <span class="p">{</span> <span class="s">&#39;print_support&#39;</span><span class="p">:</span>
    <span class="na">identity</span>           <span class="o">=&gt;</span> <span class="p">[</span><span class="s">&#39;unix_group:*&#39;</span><span class="p">],</span>
    <span class="na">action</span>             <span class="o">=&gt;</span> <span class="s">&#39;org.opensuse.cupskhelper.mechanism.*&#39;</span><span class="p">,</span>
    <span class="na">section_name</span>       <span class="o">=&gt;</span> <span class="s">&#39;Allow all print management permissions&#39;</span><span class="p">,</span>
    <span class="na">result_any</span>         <span class="o">=&gt;</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span>
    <span class="na">result_interactive</span> <span class="o">=&gt;</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span>
    <span class="na">result_active</span>      <span class="o">=&gt;</span> <span class="s">&#39;yes&#39;</span>
  <span class="p">}</span>

  <span class="k">package</span> <span class="p">{</span> <span class="s">&#39;cups-pdf&#39;</span><span class="p">:</span> <span class="na">ensure</span> <span class="o">=&gt;</span> <span class="s">&#39;latest&#39;</span> <span class="p">}</span>
  <span class="k">package</span> <span class="p">{</span> <span class="s">&#39;cups-pk-helper&#39;</span><span class="p">:</span> <span class="na">ensure</span> <span class="o">=&gt;</span> <span class="s">&#39;latest&#39;</span> <span class="p">}</span>
  <span class="k">package</span> <span class="p">{</span> <span class="s">&#39;system-config-printer&#39;</span><span class="p">:</span> <span class="na">ensure</span> <span class="o">=&gt;</span> <span class="s">&#39;present&#39;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-up-a-print-server">
<h3>4.7.10.5.2. Setting up a Print Server<a class="headerlink" href="#setting-up-a-print-server" title="Permalink to this headline">¶</a></h3>
<p>Below is an example manifest called
<code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/modules/site/manifests/print/server.pp</span></code> for setting up a
print server.</p>
<div class="highlight-puppet"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="na">site</span><span class="p">::</span><span class="na">print</span><span class="p">::</span><span class="na">server</span> <span class="p">{</span><span class="c"></span>

<span class="c">  # Note, this is *not* set up for being a central print server.</span>
<span class="c">  # You&#39;ll need to add the appropriate IPTables rules for that to work.</span>
  <span class="k">package</span> <span class="p">{</span> <span class="s">&#39;cups&#39;</span><span class="p">:</span> <span class="na">ensure</span> <span class="o">=&gt;</span> <span class="s">&#39;latest&#39;</span> <span class="p">}</span>

  <span class="k">service</span> <span class="p">{</span> <span class="s">&#39;cups&#39;</span><span class="p">:</span>
    <span class="na">enable</span>     <span class="o">=&gt;</span> <span class="s">&#39;true&#39;</span><span class="p">,</span>
    <span class="na">ensure</span>     <span class="o">=&gt;</span> <span class="s">&#39;running&#39;</span><span class="p">,</span>
    <span class="na">hasrestart</span> <span class="o">=&gt;</span> <span class="s">&#39;true&#39;</span><span class="p">,</span>
    <span class="na">hasstatus</span>  <span class="o">=&gt;</span> <span class="s">&#39;true&#39;</span><span class="p">,</span>
    <span class="na">require</span>    <span class="o">=&gt;</span> <span class="k">Package</span><span class="p">[</span><span class="s">&#39;cups&#39;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="vnc-setup">
<h2>4.7.10.6. VNC Setup<a class="headerlink" href="#vnc-setup" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../../glossary.html#term-virtual-network-computing"><span class="xref std std-term">Virtual Network Computing</span></a> (VNC) is a tool that is used to manage desktops and workstations remotely
through the standard setup or a proxy.</p>
<div class="section" id="vnc-standard-setup">
<h3>4.7.10.6.1. VNC Standard Setup<a class="headerlink" href="#vnc-standard-setup" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must have the <code class="docutils literal"><span class="pre">pupmod-simp-vnc</span></code> RPM installed to use VNC on your
system!</p>
</div>
<p>To enable remote access via VNC on the system, include <code class="docutils literal"><span class="pre">vnc::server</span></code>
in Hiera for the node.</p>
<p>The default VNC setup that comes with SIMP can only be used over SSH and
includes three default settings:</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting Type</th>
<th class="head">Setting Details</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Standard</td>
<td><p class="first">Port: 5901</p>
<p class="last">Resolution: <a class="reference external" href="mailto:1024x768&#37;&#52;&#48;16">1024x768<span>&#64;</span>16</a></p>
</td>
</tr>
<tr class="row-odd"><td>Low Resolution</td>
<td><p class="first">Port: 5902</p>
<p class="last">Resolution: <a class="reference external" href="mailto:800x600&#37;&#52;&#48;16">800x600<span>&#64;</span>16</a></p>
</td>
</tr>
<tr class="row-even"><td>High Resolution</td>
<td><p class="first">Port: 5903</p>
<p class="last">Resolution: <a class="reference external" href="mailto:1280x1024&#37;&#52;&#48;16">1280x1024<span>&#64;</span>16</a></p>
</td>
</tr>
</tbody>
</table>
<p>Table: VNC Default Settings</p>
<p>To connect to any of these settings, SSH into the system running the VNC
server and provide a tunnel to <code class="docutils literal"><span class="pre">127.0.0.1:&lt;VNC</span> <span class="pre">Port&gt;</span></code>. Refer to the SSH
client&#8217;s documentation for specific instructions.</p>
<p>To set up additional VNC port settings, refer to the code in
<code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/modules/vnc/manifests/server.pp</span></code>
for examples.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>Multiple users can log on to the same system at the same time with
no adverse effects; however, none of these sessions are persistent.</p>
<p class="last">To maintain a persistent VNC session, use the <code class="docutils literal"><span class="pre">vncserver</span></code>
application on the remote host. Type <code class="docutils literal"><span class="pre">man</span> <span class="pre">vncserver</span></code> to reference
the manual for additional details.</p>
</div>
</div>
<div class="section" id="vnc-through-a-proxy">
<h3>4.7.10.6.2. VNC Through a Proxy<a class="headerlink" href="#vnc-through-a-proxy" title="Permalink to this headline">¶</a></h3>
<p>The section describes the process to VNC through a proxy. This setup
provides the user with a persistent VNC session.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">In order for this setup to work, the system must have a VNC server
(<code class="docutils literal"><span class="pre">vserver.your.domain</span></code>), a VNC client (<code class="docutils literal"><span class="pre">vclnt.your.domain</span></code>), and a
proxy (<code class="docutils literal"><span class="pre">proxy.your.domain</span></code>). A <code class="docutils literal"><span class="pre">vuser</span></code> account must also be set up
as the account being used for the VNC. The <code class="docutils literal"><span class="pre">vuser</span></code> is a common user
that has access to the server, client, and proxy.</p>
</div>
<div class="section" id="modify-puppet">
<h4>4.7.10.6.2.1. Modify Puppet<a class="headerlink" href="#modify-puppet" title="Permalink to this headline">¶</a></h4>
<p>If definitions for the machines involved in the VNC do not already exist
in Hiera, create an <code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/hieradata/hosts/vserv.your.domain.yaml</span></code>
file. In the client hosts file, modify or create the entries shown in
the examples below. These additional modules will allow vserv to act as
a VNC server and vclnt to act as a client.</p>
<p>VNC Server node</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="c1"># vserv.your.domain.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">classes</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;windowmanager::gnome&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;mozilla::firefox&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;vnc::server&#39;</span>
</pre></div>
</div>
<p>VNC client node</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="c1"># vclnt.your.domain.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">classes</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;gnome&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;mozilla::firefox&#39;</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;vnc::client&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="run-the-server">
<h4>4.7.10.6.2.2. Run the Server<a class="headerlink" href="#run-the-server" title="Permalink to this headline">¶</a></h4>
<p>As <code class="docutils literal"><span class="pre">vuser</span></code> on <code class="docutils literal"><span class="pre">vserv.your.domain</span></code>, type <code class="docutils literal"><span class="pre">vncserver</span></code>.</p>
<p>The output should mirror the following:</p>
<blockquote>
<div>New &#8216;vserv.your.domain:&lt;Port Number&gt; (vuser)&#8217; desktop is vserv.your.domain:&lt;Port Number&gt;</div></blockquote>
<p>Starting applications specified in <code class="docutils literal"><span class="pre">/home/vuser/.vnc/xstartup</span></code> Log file
is <code class="docutils literal"><span class="pre">/home/vuser/.vnc/vserv.your.domain:&lt;Port</span> <span class="pre">Number&gt;.log</span></code></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remember the port number; it will be needed to set up an SSH tunnel.</p>
</div>
</div>
<div class="section" id="set-up-an-ssh-tunnel">
<h4>4.7.10.6.2.3. Set up an SSH Tunnel<a class="headerlink" href="#set-up-an-ssh-tunnel" title="Permalink to this headline">¶</a></h4>
<p>Set up a tunnel from the client (vclnt), through the proxy server
(proxy), to the server (vserv). The table below lists the steps to set
up the tunnel.</p>
<ol class="arabic simple">
<li>On the workstation, type <code class="docutils literal"><span class="pre">ssh</span> <span class="pre">-l</span> <span class="pre">vuser</span> <span class="pre">-L</span> <span class="pre">590***&lt;Port</span> <span class="pre">Number&gt;*:localhost:590***&lt;Port</span> <span class="pre">Number&gt;***proxy.your.domain**</span></code></li>
</ol>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This command takes the user to the proxy.</p>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>On the proxy, type <code class="docutils literal"><span class="pre">ssh</span> <span class="pre">-l</span> <span class="pre">vuser</span> <span class="pre">-L</span> <span class="pre">590***&lt;Port</span> <span class="pre">Number&gt;*:localhost:590***&lt;Port</span> <span class="pre">Number&gt;***vserv.your.domain**</span></code></li>
</ol>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This command takes the user to the VNC server.</p>
</div>
</div></blockquote>
<p>Table: Set Up SSH Tunnel Procedure</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The port number in 590<em>&lt;Port Number&gt;</em> is the same port number as
previously described. For example, if the <em>&lt;Port Number&gt;</em> was 6,
then all references below to 590<em>&lt;Port Number&gt;</em> become 5906.</p>
</div>
</div>
<div class="section" id="set-up-clients">
<h4>4.7.10.6.2.4. Set Up Clients<a class="headerlink" href="#set-up-clients" title="Permalink to this headline">¶</a></h4>
<p>On <code class="docutils literal"><span class="pre">vclnt.your.domain</span></code>, type <code class="docutils literal"><span class="pre">vncviewer</span> <span class="pre">localhost:590\</span> <span class="pre">***&lt;Port</span>
<span class="pre">Number&gt;***</span></code> to open the Remote Desktop viewer.</p>
</div>
</div>
<div class="section" id="troubleshooting-vnc-issues">
<h3>4.7.10.6.3. Troubleshooting VNC Issues<a class="headerlink" href="#troubleshooting-vnc-issues" title="Permalink to this headline">¶</a></h3>
<p>If nothing appears in the terminal window, X may have crashed. To
determine if this is the case, type <code class="docutils literal"><span class="pre">ps</span> <span class="pre">-ef</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">XKeepsCrashing</span></code></p>
<p>If any matches result, stop the process associated with the command and
try to restart <code class="docutils literal"><span class="pre">vncviewer</span></code> on <code class="docutils literal"><span class="pre">vclnt.your.domain</span></code>.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Network_Build.html" class="btn btn-neutral float-right" title="4.7.11. HOWTO Kickstart the Initial Server" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Kerberos.html" class="btn btn-neutral" title="4.7.9. HOWTO Enable Kerberos" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, THE SIMP TEAM.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'4.2.X',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>